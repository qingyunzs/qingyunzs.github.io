---
layout: post
title: Apache/Nginx-MySQL+PHP
author: zrg
comments: false
description: 在Linux环境下的Apache/Nginx+MySQL+PHP源码包安装过程。内容适用于linux操作系统，仅供参考！
categories:
- software
- linux
- php
- database
tags:
- Apache
- Nginx
- MySQL
- PHP
- Memcache
- Redis
- Database
photos:
---

<p>
关于此文档，如果你有任何问题，可以发邮件到我的邮箱，邮箱地址为 zrg1390556487@gmail.com.
</p>

<p>
This is a installation process of "Apache+MySQL+PHP" source packages on linux environment.It's content only  
</p>

<div id="outline-container-orga7b5fbf" class="outline-2">
<h2 id="orga7b5fbf">前言(Preface)</h2>
<div class="outline-text-2" id="text-orga7b5fbf">
<pre class="example">
建议根据文档顺序依次安装。

</pre>
</div>
</div>
<div id="outline-container-orgb3e6f3a" class="outline-2">
<h2 id="orgb3e6f3a">安装Apache</h2>
<div class="outline-text-2" id="text-orgb3e6f3a">
</div>
<div id="outline-container-org918edae" class="outline-3">
<h3 id="org918edae">解压</h3>
<div class="outline-text-3" id="text-org918edae">
<div class="org-src-container">
<pre class="src src-emacs-lisp">#tar jxvf httpd-2.4.18.tar.bz2
#cd httpd-2.4.18/
</pre>
</div>
</div>
</div>
<div id="outline-container-org1983b49" class="outline-3">
<h3 id="org1983b49">配置</h3>
<div class="outline-text-3" id="text-org1983b49">
<div class="org-src-container">
<pre class="src src-emacs-lisp">#./configure --prefix=/usr/local/apache2 --enable-so --with-included-apr
&#27492;&#26102;&#21487;&#33021;&#20250;&#20986;&#29616;&#22914;&#19979;&#38169;&#35823;&#65292;&#36825;&#26159;&#22240;&#20026;ARP&#21644;ARP-util&#32570;&#22833;&#12290;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-1.png" alt="apache-1.png" align="center" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgcd977a3" class="outline-3">
<h3 id="orgcd977a3">安装APR和APR-util</h3>
<div class="outline-text-3" id="text-orgcd977a3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#21040; http://apr.apache.org/download.cgi &#19979;&#36733;apr&#21644;apr-util
#tar jxvf apr-1.5.2.tar.bz2
#cd apr-1.5.2/
#./configure --prefix=/usr/local/apr
&#27492;&#26102;&#65292;&#21487;&#33021;&#20250;&#20986;&#29616;libtool&#32570;&#22833;&#65292;&#22914;&#19979;&#22270;&#25152;&#31034;&#12290;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-2.png" alt="apache-2.png" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#35299;&#20915;&#21150;&#27861;&#65306;
 &#23433;&#35013;libtool&#12289;autoconf&#21450;automake&#65306;#zypper in autoconf libtool automake
 &#28982;&#21518;&#25191;&#34892;&#65306;# autoreconf --force --install
       #autoreconf --force --install
       #autoreconf --force --install
       &#20043;&#21518;&#65292;&#25171;&#24320;configure&#25991;&#20214;(&#29616;&#22312;&#20351;&#29992;&#30340;&#29256;&#26412;&#26159;apr-1.5.2&#65292;30212&#34892;)&#65292;&#27880;&#37322;   $RM -f <span style="color: #E6DB74;">"$cfgfile"</span>&#65292;&#23601;&#26159;&#22312;&#21069;&#38754;&#28155;&#21152;&#8220;#&#8221;&#12290;
&#37325;&#26032;&#25191;&#34892;./configure --prefix=/usr/local/apr&#65292;&#38382;&#39064;&#35299;&#20915;&#12290;
&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-3.png" alt="apache-3.png" height="600px" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#32534;&#35793;&#23433;&#35013;apr
#make <span style="color: #66D9EF;">&amp;&amp;</span> make install &#65292;&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-4.png" alt="apache-4.png" width="800px" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#25509;&#19979;&#26469;&#65292;&#23433;&#35013;APR-util&#12290;
&#21516;&#26679;&#65292;&#35299;&#21387;&#37197;&#32622;&#65292;&#27880;&#24847;&#20351;&#29992;&#20102;--with-apr&#65306;
#tar apr-util-1.5.4.tar.bz2
#cd apr-util-1.5.4/
# ./configure --with-apr=/usr/local/apr
&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-5.png" alt="apache-5.png" height="450px" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">#make <span style="color: #66D9EF;">&amp;&amp;</span> make install &#65292;&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-6.png" alt="apache-6.png" height="450px" align="center" />
</p>
</div>
</div>
</div>
<div id="outline-container-org4a9ae7d" class="outline-3">
<h3 id="org4a9ae7d">运行安装apache（httpd）</h3>
<div class="outline-text-3" id="text-org4a9ae7d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">#./configure --prefix=/usr/local/apache2 --enable-so
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-7.png" alt="apache-7.png" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#35299;&#20915;&#21150;&#27861;&#65306;&#21040;https://sourceforge.net/projects/pcre/files/ &#19979;&#36733;pcre&#24182;&#23433;&#35013;&#12290;
#./configure --prefix=/usr/local/pcre
&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-8.png" alt="apache-8.png" height="500px" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">#make <span style="color: #66D9EF;">&amp;&amp;</span> make install &#65292;&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-9.png" alt="apache-9.png" width="820px" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#36827;&#20837;apache&#30446;&#24405;&#65292;&#37325;&#26032;&#36816;&#34892;&#37197;&#32622;&#21629;&#20196;&#65306;
#./configure --prefix=/usr/local/apache2 --enable-so &#65292;&#38382;&#39064;&#35299;&#20915;&#12290;
&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-10.png" alt="apache-10.png" heght="600px" width="480px" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">#make <span style="color: #66D9EF;">&amp;&amp;</span> make install &#65292;&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-11.png" alt="apache-11.png" width="650px" align="center" />
</p>
</div>
<pre class="example">
至此，Apache安装成功

</pre>
</div>
</div>
<div id="outline-container-org8e2ee81" class="outline-3">
<h3 id="org8e2ee81">启动Apache</h3>
<div class="outline-text-3" id="text-org8e2ee81">
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#22240;&#20026;&#26159;&#28304;&#30721;&#21253;&#23433;&#35013;&#65292;&#25152;&#20197;&#21482;&#33021;&#25191;&#34892;&#19979;&#21015;&#21629;&#20196;&#65306;
# /usr/local/apache2/bin/apachectl start
&#27492;&#26102;&#65292;&#20986;&#29616;&#19979;&#22270;&#38169;&#35823;&#65292;&#36825;&#26159;&#22240;&#20026;ServerName&#37197;&#32622;&#19981;&#27491;&#30830;&#30340;&#21407;&#22240;&#12290;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/apache-12.png" alt="apache-12.png" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#35299;&#20915;&#65306;# vim httpd.conf
ServerName localhost:80

&#25913;&#23436;&#21518;&#65292;&#37325;&#21551;apache&#65306;# /usr/local/apache2/bin/apachectl restart
&#21487;&#20197;&#26597;&#30475;&#24320;&#21457;&#31471;&#21475;&#21495;&#65306;# netstat -tnlp
</pre>
</div>
</div>
</div>
<div id="outline-container-org33a61a7" class="outline-3">
<h3 id="org33a61a7">设置开机启动</h3>
<div class="outline-text-3" id="text-org33a61a7">
<div class="org-src-container">
<pre class="src src-emacs-lisp"># cp /usr/local/apache2/bin/apachectl /etc/init.d
# chmod 755 /etc/init.d/apachectl
# chkconfig --add apachectl                   &#65307;add&#23545;&#24212;del
# chkconfig --level 35 apachectl on        &#65307;on&#23545;&#24212;off
# chkconfig --list                    &#65307;&#26174;&#31034;&#24320;&#26426;&#21487;&#20197;&#33258;&#21160;&#21551;&#21160;&#30340;&#26381;&#21153;
</pre>
</div>
</div>
</div>
<div id="outline-container-org3a8ed2a" class="outline-3">
<h3 id="org3a8ed2a">配置Virtual Host</h3>
<div class="outline-text-3" id="text-org3a8ed2a">
</div>
<div id="outline-container-org2deaf92" class="outline-4">
<h4 id="org2deaf92">Configure virtual host</h4>
<div class="outline-text-4" id="text-org2deaf92">
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orga3f65ee">LoadModule vhost_alias_module modules/mod_vhost_alias.so
# Virtual hosts 
Include conf/extra/httpd-vhosts.conf
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orged6765c">&lt;VirtualHost 127.0.0.1:80&gt;
    #directory
    DocumentRoot <span style="color: #E6DB74;">"D:</span><span style="color: #FD971F; font-weight: bold; font-style: italic; text-decoration: underline;">\</span><span style="color: #E6DB74;">phpStudy</span><span style="color: #FD971F; font-weight: bold; font-style: italic; text-decoration: underline;">\</span><span style="color: #E6DB74;">WWW\ec-shop</span><span style="color: #FD971F; font-weight: bold; font-style: italic; text-decoration: underline;">\</span><span style="color: #E6DB74;">gold"</span>
    ServerName local.gold
    #    ServerAlias www.dummy-host.example.com
    #    ErrorLog <span style="color: #E6DB74;">"logs/dummy-host.example.com-error.log"</span>
    #    CustomLog <span style="color: #E6DB74;">"logs/dummy-host.example.com-access.log"</span> common
    DirectoryIndex index.html index.htm index.php
    &lt;Directory /&gt;
      Options FollowSymLinks
      #&#19981;&#35768;&#21487;&#21035;&#20154;&#20462;&#25913;&#25105;&#20204;&#30340;&#39029;&#38754;
      AllowOverride None
      #&#35774;&#32622;&#35775;&#38382;&#26435;&#38480;
      Order allow,deny
      Allow from all
    &lt;/Directory&gt;
&lt;/VirtualHost&gt;
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org393aa12">127.0.0.1 local.gold
Explain:
      a.About hosts:a computer file to be used to store information on where to find an internet host on a computer network

      b.When the user input a URL in the browser, the system will automatically search for the corresponding IP address 
        from the Hosts file, once found, the system will immediately open the corresponding page, if not found, then the 
        system will be submitted to the DNS domain name resolution server IP address.
</pre>
</div>
</div>
</div>
<div id="outline-container-orgf7d1bd7" class="outline-4">
<h4 id="orgf7d1bd7">Configure multiple ports and multiple sites</h4>
<div class="outline-text-4" id="text-orgf7d1bd7">
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orge4ebad5">Add listening port:
  Listen 81
  Listen 82
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orgde5d414">&lt;VirtualHost *:81&gt;
#    ServerAdmin webmaster@dummy-host2.example.com
     DocumentRoot <span style="color: #E6DB74;">"d:</span><span style="color: #FD971F; font-weight: bold; font-style: italic; text-decoration: underline;">\</span><span style="color: #E6DB74;">wamp</span><span style="color: #FD971F; font-weight: bold; font-style: italic; text-decoration: underline;">\</span><span style="color: #E6DB74;">www</span><span style="color: #FD971F; font-weight: bold; font-style: italic; text-decoration: underline;">\</span><span style="color: #E6DB74;">wp-job"</span>
     ServerName localhost
#    ErrorLog <span style="color: #E6DB74;">"logs/dummy-host2.example.com-error.log"</span>
#    CustomLog <span style="color: #E6DB74;">"logs/dummy-host2.example.com-access.log"</span> common
&lt;/VirtualHost&gt;

&lt;VirtualHost *:82&gt;
#    ServerAdmin webmaster@dummy-host2.example.com
     DocumentRoot <span style="color: #E6DB74;">"d:</span><span style="color: #FD971F; font-weight: bold; font-style: italic; text-decoration: underline;">\</span><span style="color: #E6DB74;">wamp</span><span style="color: #FD971F; font-weight: bold; font-style: italic; text-decoration: underline;">\</span><span style="color: #E6DB74;">www</span><span style="color: #FD971F; font-weight: bold; font-style: italic; text-decoration: underline;">\</span><span style="color: #E6DB74;">wordpress"</span>
     ServerName localhost
#    ErrorLog <span style="color: #E6DB74;">"logs/dummy-host2.example.com-error.log"</span>
#    CustomLog <span style="color: #E6DB74;">"logs/dummy-host2.example.com-access.log"</span> common
&lt;/VirtualHost&gt;
</pre>
</div>
</div>
</div>
</div>
</div>
<div id="outline-container-orgfbaeb61" class="outline-2">
<h2 id="orgfbaeb61">安装Nginx</h2>
<div class="outline-text-2" id="text-orgfbaeb61">
</div>
<div id="outline-container-org531c082" class="outline-3">
<h3 id="org531c082">Nginx 介绍</h3>
<div class="outline-text-3" id="text-org531c082">
<pre class="example">
Nginx是一款免费、开源、高效的 HTTP 服务器，Nginx是以稳定著称，丰富的功能，结构简单，低资源消耗。

</pre>
</div>
</div>
<div id="outline-container-org463414c" class="outline-3">
<h3 id="org463414c">配置yum源</h3>
<div class="outline-text-3" id="text-org463414c">
<pre class="example">
[nginx]
name=nginx repo
baseurl=http://nginx.org/packages/centos/$releasever/$basearch/
gpgcheck=0
enabled=1
</pre>
</div>
</div>
<div id="outline-container-org6ad5465" class="outline-3">
<h3 id="org6ad5465">安装(Installing)</h3>
<div class="outline-text-3" id="text-org6ad5465">
<pre class="example">
yum install -y nginx

</pre>

<pre class="example">
//设置nginx开机自启动
systemctl enable nginx.service

</pre>

<pre class="example">
//启动/停止/重新启动nginx
systemctl start/stop/restart nginx.service

</pre>
</div>
</div>
<div id="outline-container-org9c37b35" class="outline-3">
<h3 id="org9c37b35">打开 HTTP 和 HTTPS 防火墙端口</h3>
<div class="outline-text-3" id="text-org9c37b35">
<pre class="example">
firewall-cmd –permanent –zone=public –add-service=http
firewall-cmd –permanent –zone=public –add-service=https
firewall-cmd –reload

</pre>
</div>
</div>
<div id="outline-container-org84c165e" class="outline-3">
<h3 id="org84c165e">配置Nginx</h3>
<div class="outline-text-3" id="text-org84c165e">
</div>
<div id="outline-container-org4f12aef" class="outline-4">
<h4 id="org4f12aef">/etc/nginx/conf.d/default.conf</h4>
<div class="outline-text-4" id="text-org4f12aef">
<pre class="example">
环境要求:能够正常访问网页

</pre>
<div class="org-src-container">
<pre class="src src-emacs_lisp">server {
    listen       80;
    server_name  localhost;

    #charset koi8-r;
    access_log  /var/log/nginx/default.access.log  main;

    location / {
	root   /srv/www;
	index  index.php index.html index.htm;
    }

    error_page  404              /404.html;

    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
	root   /srv/www;
    }

    # proxy the PHP scripts to Apache listening on 127.0.0.1:80
    #
    #location ~ \.php$ {
    #    proxy_pass   http://127.0.0.1;
    #}

    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
    #
    location ~ \.php$ {
	root           /srv/www;
	fastcgi_pass   127.0.0.1:9000;
	fastcgi_index  index.php;
	fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
	include        fastcgi_params;
    }

    # deny access to .htaccess files, if Apache's document root
    # concurs with nginx's one
    #
    location ~ /\.ht {
	deny  all;
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org451f05e" class="outline-4">
<h4 id="org451f05e">/etc/nginx/conf.d/vhosts/finance.conf</h4>
<div class="outline-text-4" id="text-org451f05e">
<pre class="example">
环境要求：php, ThinkPHP5, pathinfo,  

</pre>
<div class="org-src-container">
<pre class="src src-emacs-lisp">server {
    listen       8080<span style="color: #75715E;">;</span>
    server_name  localhost<span style="color: #75715E;">;</span>

    #charset koi8-r<span style="color: #75715E;">;</span>
    access_log  /var/log/nginx/finance.access.log  main<span style="color: #75715E;">;</span>

    location / {
        root   /srv/www/finance/public<span style="color: #75715E;">;</span>
        index  index.php index.html index.htm<span style="color: #75715E;">;</span>
        if (!-e $request_filename) {
                rewrite  ^(.*)$ /index.php?s=/$1 last<span style="color: #75715E;">;</span>
                break<span style="color: #75715E;">;</span>
        }
    }

    error_page  404              /404.html<span style="color: #75715E;">;</span>

    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html<span style="color: #75715E;">;</span>
    location = /50x.html {
        root   /srv/www<span style="color: #75715E;">;</span>
    }

    # proxy the PHP scripts to Apache listening on 127.0.0.1:80
    #
    #location ~ \.php$ {
    #    proxy_pass   http://127.0.0.1<span style="color: #75715E;">;</span>
    #}

    # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000
    #
    location ~ \.php$ {
         root           /srv/www/finance/public<span style="color: #75715E;">;</span>
         fastcgi_pass   127.0.0.1:9000<span style="color: #75715E;">;</span>
         fastcgi_index  index.php<span style="color: #75715E;">;</span>
         fastcgi_param  PHP_VALUE  <span style="color: #E6DB74;">"open_basedir=/srv/www/finance/:/tmp/:/proc/"</span><span style="color: #75715E;">;</span>
         fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name<span style="color: #75715E;">;</span>
         include        fastcgi_params<span style="color: #75715E;">;</span>

         set $real_script_name $fastcgi_script_name<span style="color: #75715E;">;</span>
            if ($fastcgi_script_name ~ <span style="color: #E6DB74;">"^(.+?</span><span style="color: #FD971F; font-weight: bold; font-style: italic; text-decoration: underline;">\</span><span style="color: #E6DB74;">.php)(/.+)$"</span>) {
            set $real_script_name $1<span style="color: #75715E;">;</span>
            set $path_info $2<span style="color: #75715E;">;</span>
         }
         fastcgi_param SCRIPT_FILENAME $document_root$real_script_name<span style="color: #75715E;">;</span>
         fastcgi_param SCRIPT_NAME $real_script_name<span style="color: #75715E;">;</span>
         fastcgi_param PATH_INFO $path_info<span style="color: #75715E;">;</span>
    }

    # deny access to .htaccess files, if Apache's document root
    # concurs with nginx's one
    #
    location ~ /\.ht {
        deny  all<span style="color: #75715E;">;</span>
    }
}
</pre>
</div>
</div>
</div>
<div id="outline-container-orgc15f610" class="outline-4">
<h4 id="orgc15f610">nginx问题解决</h4>
<div class="outline-text-4" id="text-orgc15f610">
<pre class="example">
1. 403 Forbidden
问题分析：1）检查文件或目录(/srv/www/)权限问题；2）配置检查：访问文件类型，index index.php index.html index.htm

</pre>

<pre class="example">
2.访问时，出现以下内容：
File not found. 
No input file specified.
问题分析：1）检查路径配置是否正确；2）检查php-fpm配置

</pre>

<pre class="example">
3.

</pre>
</div>
</div>
</div>
<div id="outline-container-orgdba4252" class="outline-3">
<h3 id="orgdba4252">参考资料</h3>
<div class="outline-text-3" id="text-orgdba4252">
<pre class="example">
http://www.nginx.cn/231.html
https://www.nginx.com/
https://www.nginx.com/resources/wiki/start/topics/tutorials/install/

</pre>
</div>
</div>
</div>
<div id="outline-container-org5fb81ba" class="outline-2">
<h2 id="org5fb81ba">安装MySQL</h2>
<div class="outline-text-2" id="text-org5fb81ba">
<pre class="example">
注意：这里下载的是rpm安装包。

</pre>
<div class="org-src-container">
<pre class="src src-emacs-lisp">1.rpm&#23433;&#35013;&#26102;&#65292;&#25253;&#22914;&#19979;&#38169;&#35823;&#65292;&#36825;&#26159;&#22240;&#20026;&#38656;&#35201;&#23433;&#35013;&#36825;&#20123;&#20381;&#36182;&#21253;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/mysql-1.png" alt="mysql-1.png" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#25110;&#26159;&#36825;&#26679;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/mysql-2.png" alt="mysql-2.png" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#22914;&#26524;&#26159;&#31532;&#19968;&#20010;&#22270;&#25152;&#31034;&#38169;&#35823;&#65292;&#21487;&#20197;&#19979;&#36733;&#23433;&#35013;numactl&#65292;
# wget http://mirror.centos.org/centos/6/os/x86_64/Packages/numactl-2.0.9-2.el6.x86_64.rpm
# rpm -ivh numactl-2.0.9-2.el6.x86_64.rpm

&#22914;&#26524;&#26159;&#31532;&#20108;&#20010;&#22270;&#25152;&#31034;&#38169;&#35823;&#65292;&#21487;&#20197;
#rpm -ivh glibc-2.17-4.17.1.x86_64.rpm --force
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#25509;&#30528;&#20381;&#27425;&#23433;&#35013;mysql&#38468;&#24102;&#36719;&#20214;&#65306;
# rpm -ivh mysql-community-libs-5.6.28-2.sles12.x86_64.rpm
# rpm -ivh mysql-community-client-5.6.28-2.sles12.x86_64.rpm
# rpm -ivh mysql-community-common-5.6.28-2.sles12.x86_64.rpm
# rpm -ivh mysql-community-server-5.6.28-2.sles12.x86_64.rpm

&#22312;&#27492;&#23433;&#35013;&#36807;&#31243;&#20013;&#65292;&#21487;&#33021;&#24050;&#32463;&#23433;&#35013;&#23427;&#20854;&#20182;&#29256;&#26412;&#30340;mysql&#65292;&#21487;&#20197;&#36890;&#36807;&#21024;&#38500;&#20854;&#20182;&#29256;&#26412;&#65292;&#22312;&#36827;&#34892;&#23433;&#35013;&#12290;
</pre>
</div>
<pre class="example">
安装完成后，可以通过 # mysql_secure_installation 命令设置root用户密码。

</pre>
</div>
<div id="outline-container-orgda3f3eb" class="outline-3">
<h3 id="orgda3f3eb">安装MariaDB</h3>
<div class="outline-text-3" id="text-orgda3f3eb">
<pre class="example">
//非源码安装方式
yum install mariadb mariadb-server net-tools

</pre>
</div>
</div>
</div>
<div id="outline-container-org7cb9b6c" class="outline-2">
<h2 id="org7cb9b6c">安装PHP</h2>
<div class="outline-text-2" id="text-org7cb9b6c">
</div>
<div id="outline-container-orga534a15" class="outline-3">
<h3 id="orga534a15">安装php扩展</h3>
<div class="outline-text-3" id="text-orga534a15">
</div>
<div id="outline-container-org35dcfeb" class="outline-4">
<h4 id="org35dcfeb">jpeg</h4>
<div class="outline-text-4" id="text-org35dcfeb">
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#23448;&#32593;&#19979;&#36733;&#22320;&#22336;&#65306;http://www.ijg.org/
&#23433;&#35013;&#26102;&#38656;&#35201;&#22312;&#23433;&#35013;&#30446;&#24405;jpeg&#19979;&#26032;&#24314;bin&#65292;include&#65292;lib&#65292;man/man1&#30446;&#24405;&#12290;
#tar -zvxf jpegsrc.v6b.tar.gz
#cd jpeg-6b
#CFLAGS=<span style="color: #E6DB74;">"-O3 -fPIC"</span> ./configure --prefix=/usr/local/jpeg6/ --enable-shared --enable-static
&#27492;&#26102;&#21487;&#33021;&#20250;&#25253;&#20986;&#29616;&#22914;&#19979;&#38169;&#35823;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-1.png" alt="php-1.png" align="center" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#35299;&#20915;&#65306;&#22797;&#21046;config.guess&#21644;config.sub&#21040;&#23433;&#35013;&#30446;&#24405;&#19979;
#cp /usr/share/libtool/config/config.guess ./
#cp /usr/share/libtool/config/config.sub ./
&#20877;&#27425;&#25191;&#34892;&#19978;&#38754;&#30340;&#37197;&#32622;&#35821;&#21477;&#12290;&#38382;&#39064;&#35299;&#20915;&#12290;
&#20351;&#29992;64&#20301;&#20989;&#25968;&#24211;&#32534;&#35793;&#23433;&#35013;&#65306;
make libdir=/usr/lib64 <span style="color: #66D9EF;">&amp;&amp;</span> make libdir=/usr/lib64 install
&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-2.png" alt="php-2.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgdd68e81" class="outline-4">
<h4 id="orgdd68e81">libpng</h4>
<div class="outline-text-4" id="text-orgdd68e81">
<div class="org-src-container">
<pre class="src src-emacs-lisp">libpng&#26080;&#38656;&#37197;&#32622;
#cp scripts/makefile.std makefile
#vim makefile 
&#25214;&#21040;CFLAGS&#65292;&#21152;&#20837;-O3 -fPIC -I$(ZLIBINC)
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-3.png" alt="php-3.png" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">#make <span style="color: #66D9EF;">&amp;&amp;</span> make install
&#27492;&#26102;&#65292;&#21487;&#33021;&#20250;&#20986;&#29616;&#38169;&#35823;&#65292;&#35299;&#20915;&#65306;&#20808;&#25226;Zlib&#23433;&#35013;&#20102;&#65292;&#22312;&#37325;&#26032;&#23433;&#35013;libpng&#65292;&#22914;&#26524;&#20173;&#28982;&#25253;&#38169;&#65292;&#36816;&#34892;&#23433;&#35013;zlib-devel
 rpm -ivh zlib-devel-1.2.8-5.1.2.x86_64.rpm
</pre>
</div>
<p>
<img src="{{site.url}}/assets/images/php-4.png" alt="php-4.png" />
重新编译出现下图提示信息，此时只需执行下面两个命令即可：
<img src="{{site.url}}/assets/images/php-5.png" alt="php-5.png" />
</p>
<div class="org-src-container">
<pre class="src src-emacs-lisp">#make clean
&#22312;&#36816;&#34892;&#19968;&#19979;&#65306;
#ldconfig    #&#21160;&#24577;&#38142;&#25509;&#24211;&#31649;&#29702;&#21629;&#20196;&#65292;
</pre>
</div>
</div>
</div>
<div id="outline-container-org5ad02bf" class="outline-4">
<h4 id="org5ad02bf">freetype</h4>
<div class="outline-text-4" id="text-org5ad02bf">
<div class="org-src-container">
<pre class="src src-emacs-lisp">Freetypr:http://download.savannah.gnu.org/releases/freetype/freetype-2.3.5.tar.gz
# ./configure --prefix=/usr/local/freetype
&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-6.png" alt="php-6.png" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">#make <span style="color: #66D9EF;">&amp;&amp;</span> make install
&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-7.png" alt="php-7.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org7c06b55" class="outline-4">
<h4 id="org7c06b55">zlib</h4>
<div class="outline-text-4" id="text-org7c06b55">
<div class="org-src-container">
<pre class="src src-emacs-lisp">#./configure --prefix=/usr/local/zlib
&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-8.png" alt="php-8.png" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">#make <span style="color: #66D9EF;">&amp;&amp;</span> make install
&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-9.png" alt="php-9.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-org078f0ce" class="outline-4">
<h4 id="org078f0ce">gd</h4>
<div class="outline-text-4" id="text-org078f0ce">
<div class="org-src-container">
<pre class="src src-emacs-lisp">CFLAGS=<span style="color: #E6DB74;">"-O3 -fPIC"</span> ./configure --prefix=/usr/local/gd --with-jpeg=/usr/local/jpeg 
 --with-png=/usr/local/lib --with-zlib=/usr/local/zlib --with-freetype=/usr/local/freetype
&#25104;&#21151;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-10.png" alt="php-10.png" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#32534;&#35793;&#23433;&#35013;&#65306;
# make <span style="color: #66D9EF;">&amp;&amp;</span> make install
&#21487;&#33021;&#20250;&#25253;&#22914;&#19979;&#38169;&#35823;&#65292;&#26816;&#26597;libpng&#26159;&#21542;&#23433;&#35013;&#27491;&#30830;&#12290;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-11.png" alt="php-11.png" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#23433;&#35013;&#23436;&#25104;&#26631;&#24535;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-12.png" alt="php-12.png" />
</p>
</div>
</div>
</div>
<div id="outline-container-orgcc4beec" class="outline-4">
<h4 id="orgcc4beec">curl</h4>
<div class="outline-text-4" id="text-orgcc4beec">
<pre class="example">
下载地址 http://curl.haxx.se/
#./configure --prefix=/usr/local/curl
#make &amp;&amp; make install ，成功标志:

</pre>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-13.png" alt="php-13.png" />
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-org76f533c" class="outline-3">
<h3 id="org76f533c">安装php</h3>
<div class="outline-text-3" id="text-org76f533c">
<pre class="example">
$ tar zxvf php-5.4.45.tar.gz
$ cd php-5.4.45
$ ./configure --prefix=/usr/local/php \
--with-apxs2=/usr/local/apache2/bin/apxs \
--with-gd \
--with-jpeg-dir=/usr/local/jpeg6 \
--with-zlib-dir=/usr/local/zlib \
--with-png-dir=/usr/local/lib \
--with-freetype-dir=/usr/local/freetype \
--with-curl=/usr/local/curl \
--with-mysql \
--with-pdo-mysql \
--with-mysqli 
--enable-ftp \
--with-pcre-regex \
--with-mhash \
--enable-fpm \
--enable-mbstring \
--enable-sockets \
--enable-sysvsem \
--enable-sysvshm \
--enable-pcntl \
--enable-mbregex \
--enable-zip \
--enable-fileinfo \

</pre>
<p>
此时，会报下图错误，解决办法就是安装zlib-devel，# zypper in libxml2-devel -y
<img src="{{site.url}}/assets/images/php-14.png" alt="php-14.png" />
重新执行上面的配置命令。出现字样"Thank you for using PHP."，表示成功了。成功标志：
<img src="{{site.url}}/assets/images/php-15.png" alt="php-15.png" />
编译安装：
</p>
<pre class="example">
# make &amp;&amp; make install

</pre>
<p>
成功标志：
<img src="{{site.url}}/assets/images/php-16.png" alt="php-16.png" />
</p>
</div>
</div>
<div id="outline-container-org1e4a606" class="outline-3">
<h3 id="org1e4a606">检测PHP是否安装成功</h3>
<div class="outline-text-3" id="text-org1e4a606">
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#35831;&#26816;&#26597;httpd.conf&#25991;&#20214;&#20013;&#65292;&#19979;&#38754;&#20004;&#34892;&#20195;&#30721;&#26159;&#21542;&#24050;&#28155;&#21152;&#65306;
LoadModule php5_module        modules/libphp5.so
...
AddType application/x-httpd-php .php
AddType application/x-httpd-php-source .phps
...
&lt;IfModule dir_module&gt;
DirectoryIndex index.php index.html
&lt;/IfModule&gt;

&#32534;&#36753;&#23436;&#25104;&#21518;&#65292;&#37325;&#21551;apache&#65306; /etc/init.d/apachectl restart

&#21019;&#24314;&#21644;&#32534;&#36753;php.ini&#65306;
#cp php.ini-development /usr/local/php/lib64/
#cd  /usr/local/php/lib64/
#cp php.ini-development php.ini
#vim php.ini
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-17.png" alt="php-17.png" />
</p>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#26032;&#24314;&#25991;&#20214;&#26597;&#30475;phpinfo&#26159;&#21542;&#37117;&#24050;&#21152;&#36733;&#24182;&#27491;&#24120;&#26174;&#31034;&#65292;
&lt;?php
phpinfo()<span style="color: #75715E;">;</span>
?&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-org465320e" class="outline-3">
<h3 id="org465320e">bcmath扩展安装</h3>
<div class="outline-text-3" id="text-org465320e">
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#20063;&#35768;&#36825;&#20010;&#25193;&#23637;&#20250;&#29992;&#21040;&#12290;

&#19968;&#33324;&#24773;&#20917;&#19979;&#36825;&#20010;&#25193;&#23637;&#22312;php&#23433;&#35013;&#30340;&#26102;&#20505;&#65292;&#26159;&#23384;&#22312;&#23433;&#35013;&#21253;&#20013;ext/bcmath&#30446;&#24405;&#19979;&#12290;&#21033;&#29992;phpize&#36827;&#34892;&#23433;&#35013;&#26032;&#30340;php&#25193;&#23637;&#12290;
#cd ext/bcmath/
#/usr/local/php/bin/phpize                    &#65307;&#25191;&#34892;(phpize&#30340;&#36335;&#24452;&#26681;&#25454;&#21508;&#33258;&#23433;&#35013;&#26377;&#25152;&#19981;&#21516;)
#find /usr/local/php/ -name php-config                &#65307;&#20808;&#26597;&#25214;php-config&#22312;&#21738;&#20010;&#22320;&#26041;
#./configure --with-php-config=/usr/local/php/bin/php-config          &#65307;&#37197;&#32622;bcmath
# make
# make install
# find /usr/local/php/ -name bcmath.so            &#65307;&#26597;&#30475;bcmath.so&#22312;&#37027;&#20010;&#36335;&#24452;&#19979;
&#29616;&#22312;&#37197;&#32622;php&#65292;&#21046;&#23450;&#25193;&#23637;&#36335;&#24452;&#21450;&#21152;&#36733;so&#25991;&#20214;&#65306;
</pre>
</div>

<div class="figure">
<p><img src="{{site.url}}/assets/images/php-18.png" alt="php-18.png" />
</p>
</div>
<pre class="example">
需要安装其他扩展，使用同样的操作。

</pre>
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#29305;&#21035;&#25552;&#31034;1&#65306;
 &#21487;&#33021;&#22312;make&#30340;&#26102;&#20505;&#65292;&#20250;&#36935;&#21040;&#38169;&#35823;
 &#38169;&#35823;&#65306;&#8216;<span style="color: #AE81FF;">PHP_FE_END</span>&#8217;&#26410;&#22768;&#26126;(&#19981;&#22312;&#20989;&#25968;&#20869;) -----{error: &#8216;<span style="color: #AE81FF;">PHP_FE_END</span>&#8217; undeclared here (not in a function)}
 &#35299;&#20915;&#26041;&#27861;&#65306; &#28304;&#20195;&#30721;&#26377;&#38169;&#35823;&#65292;&#36827;&#20837;php-5.3.18/ext/mcrypt&#30446;&#24405;
 sed -i 's|PHP_FE_END|{NULL,NULL,NULL}|' ./*.c
 sed -i 's|ZEND_MOD_END|{NULL,NULL,NULL}|' ./*.c
 &#20877;&#37325;&#26032;make <span style="color: #66D9EF;">&amp;&amp;</span> make install

&#29305;&#21035;&#25552;&#31034;2&#65306;
 openssl&#25193;&#23637;&#23433;&#35013;&#65292;&#38656;&#35201;&#23433;&#35013;libssl-dev,
 $ sudo apt-get install libssl-dev

&#29305;&#21035;&#25552;&#31034;3&#65306;
 openssl&#25193;&#23637;&#23433;&#35013;&#37197;&#32622;&#26102;&#65292;&#20986;&#29616;&#38169;&#35823;&#20449;&#24687;&#65306;cannot find config.m4
 &#35299;&#20915;&#65306;mv config0.m4 config.m4
</pre>
</div>
</div>
</div>
<div id="outline-container-orgb2e8143" class="outline-3">
<h3 id="orgb2e8143">php-fpm配置</h3>
<div class="outline-text-3" id="text-orgb2e8143">
<pre class="example">
cp /usr/local/php/etc/php-fpm.conf.default etc/php-fpm.conf
vim /usr/local/php/etc/php-fpm.conf
content:
        user=username
        group=groupname

</pre>

<pre class="example">
//开启php-fpm
/usr/local/php/sbin/php-fpm start

</pre>
</div>
</div>
</div>
<div id="outline-container-org3fbb97d" class="outline-2">
<h2 id="org3fbb97d">Memcache安装指南</h2>
<div class="outline-text-2" id="text-org3fbb97d">
</div>
<div id="outline-container-org5fbc5bd" class="outline-3">
<h3 id="org5fbc5bd">服务端安装</h3>
<div class="outline-text-3" id="text-org5fbc5bd">
<pre class="example">
//安装必须组件
$apt-get install libevent-dev
或下载libevent-dev源码安装：libevent.org or https://sourceforge.net/projects/levent/

</pre>

<pre class="example">
//下载Memcached
网址：http://memcached.org/downloads

</pre>

<pre class="example">
//安装Memcached
$tar zxvf memcached-1.5.4.tar.gz
$cd memcached-1.5.4
$./configure --prefix=/usr/local/memcached --with-libevent=/usr/local/libevent
$make &amp;&amp; make install
或通过apt-get命令直接安装：$apt-get install memcached

</pre>

<pre class="example">
//启动Memcached
$/usr/local/memcached/bin/memcached -m 64 -p 11211 -u nobody -vv -d
-d表示在后台运行
$ps aux |grep memcached

</pre>
</div>
</div>
<div id="outline-container-org58c3366" class="outline-3">
<h3 id="org58c3366">客户端安装</h3>
<div class="outline-text-3" id="text-org58c3366">
</div>
<div id="outline-container-orgd7d8b05" class="outline-4">
<h4 id="orgd7d8b05">第一步，安装libmemcached库</h4>
<div class="outline-text-4" id="text-orgd7d8b05">
<pre class="example">
//下载libmemcached
网址：https://launchpad.net/

</pre>

<pre class="example">
//解压安装
$tar zxvf libmemcached-1.0.18.tar.gz
$cd libmemcached-1.0.18
$./configure --prefix=/usr/local/libmemcached
#make &amp;&amp; make install

</pre>
</div>
</div>
<div id="outline-container-org96824d5" class="outline-4">
<h4 id="org96824d5">第二步，安装PHP memcache、memcached扩展</h4>
<div class="outline-text-4" id="text-org96824d5">
<p>
### memcache 扩展
</p>
<pre class="example">
$git clone https://github.com/websupport-sk/pecl-memcache memcache
$cd memcache
$/usr/local/php7/bin/phpize
$./configure --with-php-config=/usr/local/php7/bin/php-config
#make &amp;&amp; make install
//编辑php.ini文件，加入：extension=memcache.so
//重启Apache，查看memcache扩展是否加载

</pre>
<p>
### memcached 扩展
</p>
<pre class="example">
$git clone https;//github.com/php-memcached-dev/php-memcached.git
$cd php-memcached
$git checkout php7 //进入php7分支
$/usr/local/php7/bin/phpize
$./configure --with-php-config=/usr/local/php7/bin/php-config \
--with-libmemcached-dir=/usr/local/libmemcached
--disable-memcached-sasl
//同样，编辑PHP配置文件，加入：extension=memcached.so
//重启Apache，查看memcached扩展是否加载

</pre>
</div>
</div>
</div>
<div id="outline-container-org3a0409f" class="outline-3">
<h3 id="org3a0409f">参考资料</h3>
<div class="outline-text-3" id="text-org3a0409f">
<pre class="example">
memcache官网：http://memcache.org/
Linux Memcached 安装：http://www.runoob.com/memcached/memcached-install.html
linux下安装PHP memcached扩展：http://www.cnblogs.com/flywind/p/6021568.html
编译安装Memcached勾结php7：https://www.jianshu.com/p/c7e59afabc28
PHP7 下安装 memcache 和 memcached 扩展：http://www.lnmp.cn/install-memcache-and-memcached-extends-under-php7.html
Linux下的Memcache安装：http://kimi.it/257.html
Memcache基础教程：http://kimi.it/259.html

</pre>
</div>
</div>
</div>
<div id="outline-container-orga1fe486" class="outline-2">
<h2 id="orga1fe486">再次声明</h2>
<div class="outline-text-2" id="text-orga1fe486">
<div class="org-src-container">
<pre class="src src-emacs-lisp">&#30001;&#20110;&#27599;&#21488;&#26426;&#22120;&#23433;&#35013;&#30340;&#31995;&#32479;&#24182;&#38750;&#23436;&#20840;&#19968;&#26679;&#65292;&#23433;&#35013;&#31995;&#32479;&#26102;&#33258;&#24102;&#30340;&#21253;&#26377;&#25152;&#24046;&#24322;&#65292;&#25152;&#20197;&#35813;&#25351;&#21335;&#20165;&#20379;&#21442;&#32771;&#12290;&#20851;&#20110;&#35813;&#25351;&#21335;&#65292;&#22914;&#26524;&#20320;&#26377;&#20219;&#20309;&#38382;&#39064;&#65292;
&#20320;&#21487;&#20197;&#21457;&#37038;&#20214;&#21040;&#25105;&#30340;&#37038;&#31665;&#65292;&#37038;&#31665;&#22320;&#22336;&#20026; zrg1390556487@gmail.com
</pre>
</div>
</div>
</div>
<div id="outline-container-org1a44ee4" class="outline-2">
<h2 id="org1a44ee4">参考资料</h2>
<div class="outline-text-2" id="text-org1a44ee4">
<pre class="example">
https://xwsoul.com/posts/684

</pre>

<pre class="example">
http://php.net/
http://www.apache.org/
https://www.mysql.com/
https://mariadb.org/

</pre>
</div>
</div>
