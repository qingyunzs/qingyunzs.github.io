---
layout: post
title: Vim 使用笔记
author: zrg
comments: false
description: Vim是一个类似于Vi的著名的功能强大、高度可定制的文本编辑器，在Vi的基础上改进和增加了很多特性。
categories: 
- software
tags:
- VIM
photos:
---

<div id="outline-container-org0146a22" class="outline-2">
<h2 id="org0146a22">Vim 快捷键</h2>
<div class="outline-text-2" id="text-org0146a22">
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above"><span class="table-number">Table 1:</span> Vim Keyboard</caption>

<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Command</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><b>插入命令</b></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">a</td>
<td class="org-left">在光标所在字符后插入</td>
</tr>

<tr>
<td class="org-left">A</td>
<td class="org-left">在光标所在行行尾插入</td>
</tr>

<tr>
<td class="org-left">i</td>
<td class="org-left">在光标所在字符前插入</td>
</tr>

<tr>
<td class="org-left">I</td>
<td class="org-left">在光标所在行行首插入</td>
</tr>

<tr>
<td class="org-left">o</td>
<td class="org-left">在光标下插入新行</td>
</tr>

<tr>
<td class="org-left">O</td>
<td class="org-left">在光标上插入新行</td>
</tr>

<tr>
<td class="org-left"><b>定位命令</b></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">\$</td>
<td class="org-left">光标移到行尾</td>
</tr>

<tr>
<td class="org-left">\^</td>
<td class="org-left">光标移到行首</td>
</tr>

<tr>
<td class="org-left">gg</td>
<td class="org-left">到第一行</td>
</tr>

<tr>
<td class="org-left">G</td>
<td class="org-left">到最后一行</td>
</tr>

<tr>
<td class="org-left">nG or :n</td>
<td class="org-left">到第n行</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><b>删除命令</b></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">x</td>
<td class="org-left">删除光标位置字符</td>
</tr>

<tr>
<td class="org-left">nx</td>
<td class="org-left">删除光标位置后的n个字符</td>
</tr>

<tr>
<td class="org-left">dd</td>
<td class="org-left">删除光标所在行，ndd删除n行</td>
</tr>

<tr>
<td class="org-left">dG</td>
<td class="org-left">删除光标所在位置到文件末尾内容</td>
</tr>

<tr>
<td class="org-left">D</td>
<td class="org-left">删除光标所在位置到行尾内容</td>
</tr>

<tr>
<td class="org-left">:n1,n2d</td>
<td class="org-left">删除指定范围的行，如:999,1003d</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><b>保存命令</b></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">:w</td>
<td class="org-left">保存修改</td>
</tr>

<tr>
<td class="org-left">:w</td>
<td class="org-left">另存为指定文件</td>
</tr>

<tr>
<td class="org-left">:wq</td>
<td class="org-left">保存修改并退出</td>
</tr>

<tr>
<td class="org-left">ZZ</td>
<td class="org-left">保存退出快捷键</td>
</tr>

<tr>
<td class="org-left">:q!</td>
<td class="org-left">不保存退出</td>
</tr>

<tr>
<td class="org-left">:wq!</td>
<td class="org-left">保存修改并退出(文件所有者及root可使用)</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">选择</td>
<td class="org-left">按v，进入可视模式，移动光标选定内容</td>
</tr>

<tr>
<td class="org-left">复制</td>
<td class="org-left">一般选定后，按y（yank）即可复制，常用命令如下：</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">yy 复制整行（nyy或者yny ，复制n行，n为数字）</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">y^ 复制当前到行头的内容</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">y$ 复制当前到行尾的内容</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">yw 复制一个word （nyw或者ynw，复制n个word，n为数字）</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">yG 复制至档尾（nyG或者ynG，复制到第n行，例如1yG或者y1G，复制到档尾） </td>
</tr>

<tr>
<td class="org-left">剪切</td>
<td class="org-left">按d（delete）剪切，基本和复制命令一样。常用命令如下：</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">d      剪切选定块到缓冲区；</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">dd    剪切整行，ndd剪切当前行以下n行。</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">d^    剪切至行首</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">d$     剪切至行尾</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">dw    剪切一个word</td>
</tr>

<tr>
<td class="org-left">粘贴</td>
<td class="org-left">按p（put），粘贴在当前光标所在行下面</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">按P，粘贴在当前光标所在行上面</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">整行的复制粘贴在游标的上（下）一行；非整行的复制则是粘贴在游标的前（后）</td>
</tr>

<tr>
<td class="org-left">撤销(undo)</td>
<td class="org-left">u,（阅读模式下按U，撤销上一步的操作）</td>
</tr>

<tr>
<td class="org-left">恢复(redo)</td>
<td class="org-left">Ctrl+r</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">搜索</td>
<td class="org-left">查找(normal模式下)</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">n/N，继续搜索下一处/上一处关键词</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">:%s/oldString/newString/g，全文替换</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">:n1,n2s/oldString/newString/g，在一定范围内替换指定字符串</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">注意：查找回车应当用\n，而替换为回车应当用\r（相当于&lt;CR&gt;）</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">Vim查找支持正则表达式，例如/vim$匹配行尾的"vim"。 需要查找特殊字符需要转义，例如/vim\\(匹配"vim\)"。</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">\c表示大小写不敏感查找，\C表示大小写敏感查找。</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">*即可查找光标所在单词（word）， 要求每次出现的前后为空白字符或标点符号。</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">例如当前为foo， 可以匹配foo bar中的foo，但不可匹配foobar中的foo。</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">g*即可查找光标所在单词的字符序列，每次出现前后字符无要求。 即foo bar和foobar中的foo均可被匹配到。</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left">查找及替换</td>
<td class="org-left">:s（substitute）, 查找和替换。语法如下：</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">:{作用范围}s/{目标}/{替换}/{替换标志}</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">例如:%s/foo/bar/g会在全局范围(%)查找foo并替换为bar，所有出现都会被替换（g）。</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">1. 作用范围分为当前行、全文、选区等等。</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">当前行：:s/foo/bar/g。</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">全文：:%s/foo/bar/g。</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">选区，在Visual模式下选择区域后输入:，Vim即可自动补全为 :'&lt;,'&gt;：:'&lt;,'&gt;s/foo/bar/g。</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">2-11行：:5,12s/foo/bar/g</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">当前行.与接下来两行+2：:.,+2s/foo/bar/g</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">2. 替换标志</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">空替换标志表示只替换从光标位置开始，目标的第一次出现：:%s/foo/bar</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">i表示大小写不敏感查找，I表示大小写敏感：</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">:%s/foo/bar/i</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left"># 等效于模式中的\c（不敏感）或\C（敏感）</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">:%s/foo\c/bar</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">c表示需要确认，例如全局查找"foo"替换为"bar"并且需要确认：:%s/foo/bar/gc</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><b>设置命令</b></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">:set nu!</td>
<td class="org-left">显示行号</td>
</tr>

<tr>
<td class="org-left">:set nonu</td>
<td class="org-left">取消行号</td>
</tr>

<tr>
<td class="org-left">syntax on</td>
<td class="org-left">语法高亮度显示</td>
</tr>

<tr>
<td class="org-left">:set ai!</td>
<td class="org-left">设置自动缩进</td>
</tr>

<tr>
<td class="org-left">:100</td>
<td class="org-left">跳到指定行:</td>
</tr>

<tr>
<td class="org-left">:split</td>
<td class="org-left">分割视窗(可加名称随便开启另一档案)</td>
</tr>

<tr>
<td class="org-left">gg=G</td>
<td class="org-left">Formart格式化</td>
</tr>

<tr>
<td class="org-left">:n/:N</td>
<td class="org-left">编辑多个文件时，下一个文件/上一个文件</td>
</tr>

<tr>
<td class="org-left"><b>注意事项</b></td>
<td class="org-left">如果设置完成后，发现功能没有起作用，检查系统下是否安装了 vim-enhanced，命令为： $ rpm -q vim-enhanced</td>
</tr>
</tbody>
<tbody>
<tr>
<td class="org-left"><b>小技巧</b></td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">:r ![命令]</td>
<td class="org-left">导入命令执行结果</td>
</tr>

<tr>
<td class="org-left">:map</td>
<td class="org-left">快捷键 触发命令</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">定义快捷键，范例：</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">:map ^P I#&lt;ESC&gt;</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">:map ^B 0x</td>
</tr>

<tr>
<td class="org-left">&#xa0;</td>
<td class="org-left">:map ^H zrg1390556487@gmail.com&lt;ESC&gt; //定义快捷键，插入邮箱</td>
</tr>

<tr>
<td class="org-left">:n1,n2s/^/#/g</td>
<td class="org-left">连续行注释</td>
</tr>

<tr>
<td class="org-left">:n1,n2s/^#//g</td>
<td class="org-left">连续行注释</td>
</tr>

<tr>
<td class="org-left">:n1,n2s/^/\/\//g</td>
<td class="org-left">连续行注释</td>
</tr>

<tr>
<td class="org-left">:ab mymail zrg@gmail.com</td>
<td class="org-left">替换，输入mymail，自动变成zrg@gmail.com</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-org6ab2e7f" class="outline-2">
<h2 id="org6ab2e7f">高亮设置</h2>
<div class="outline-text-2" id="text-org6ab2e7f">
</div>
<div id="outline-container-org5eec905" class="outline-3">
<h3 id="org5eec905">高亮颜色设置</h3>
<div class="outline-text-3" id="text-org5eec905">
<ol class="org-ol">
<li><p>
查看当前主题 
</p>
<pre class="example">
:color 
:colorscheme 
</pre></li>
<li><p>
查看vim运行目录 
</p>
<pre class="example">
:echo $VIMRUNTIME 
</pre></li>
<li><p>
查看colors目录 
</p>
<pre class="example">
$ ls /usr/share/vim/vim80 
</pre></li>
<li><p>
设置颜色主题，查看效果 
</p>
<pre class="example">
:colorscheme elflord 
</pre></li>
<li><p>
修改颜色主题 
</p>
<pre class="example">
$ vim /etc/vim/vimrc 
// 添加如下代码 
</pre>

<div class="org-src-container">
<pre class="src src-shell">colorscheme elflord 
</pre>
</div>
<pre class="example">
或者在 ~/.vimrc 中进行设置：
</pre>

<div class="org-src-container">
<pre class="src src-shell" id="orgeb72de9">highlight Search <span style="color: #a0522d;">ctermbg</span>=yellow <span style="color: #a0522d;">ctermfg</span>=black 
highlight IncSearch <span style="color: #a0522d;">ctermbg</span>=black <span style="color: #a0522d;">ctermfg</span>=yellow 
highlight MatchParen <span style="color: #a0522d;">cterm</span>=underline <span style="color: #a0522d;">ctermbg</span>=NONE <span style="color: #a0522d;">ctermfg</span>=NONE
</pre>
</div>
<pre class="example">
上述配置指定 Search 结果的前景色（foreground）为黑色，背景色（background）为灰色； 渐进搜索的前景色为黑色，背景色为黄色；光标处的字符加下划线。
</pre></li>
</ol>
</div>
</div>
<div id="outline-container-org59e33f8" class="outline-3">
<h3 id="org59e33f8">禁用/启用高亮</h3>
<div class="outline-text-3" id="text-org59e33f8">
<pre class="example">
// 禁用所有高亮
:nohighlight 或 :nohl
</pre>


<pre class="example">
//只禁用搜索高亮
:set nohlsearch
//下次搜索时，需再次启动搜索高亮
:set hlsearch
</pre>

<ul class="org-ul">
<li><p>
延时禁用
</p>
<pre class="example">
让Vim查找/替换后一段时间自动取消高亮，发生查找时自动开启呢？
</pre>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orga5ed43d"><span class="linenr">1: </span><span style="color: #8b2252;">" &#24403;&#20809;&#26631;&#19968;&#27573;&#26102;&#38388;&#20445;&#25345;&#19981;&#21160;&#20102;&#65292;&#23601;&#31105;&#29992;&#39640;&#20142;</span>
<span class="linenr">2: </span><span style="color: #8b2252;">autocmd cursorhold * set nohlsearch</span>
<span class="linenr">3: </span><span style="color: #8b2252;">"</span> &#24403;&#36755;&#20837;&#26597;&#25214;&#21629;&#20196;&#26102;&#65292;&#20877;&#21551;&#29992;&#39640;&#20142;
<span class="linenr">4: </span>noremap n <span style="color: #483d8b;">:set</span> hlsearch&lt;cr&gt;n
<span class="linenr">5: </span>noremap N <span style="color: #483d8b;">:set</span> hlsearch&lt;cr&gt;N
<span class="linenr">6: </span>noremap / <span style="color: #483d8b;">:set</span> hlsearch&lt;cr&gt;/
<span class="linenr">7: </span>noremap ? <span style="color: #483d8b;">:set</span> hlsearch&lt;cr&gt;?
<span class="linenr">8: </span>noremap * *:set hlsearch&lt;cr&gt;
</pre>
</div></li>
<li><p>
一键禁用
</p>
<pre class="example">
设置快捷键来一键禁用/开启搜索高亮：
</pre>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org942a6b1">nnoremap &lt;c-h&gt; <span style="color: #483d8b;">:call</span> DisableHighlight()&lt;cr&gt;
function! DisableHighlight()
      set nohlsearch
endfunc
</pre>
</div>
<pre class="example">
希望关闭高亮时只需要按下 Ctrl+H，当发生下次搜索时又会自动启用。
</pre></li>
<li><p>
设置生效
</p>
<pre class="example">
Notice: 设置完成后，发现功能没有起作用，检查一下系统下是否安装了vim-enhanced包，查询命令为： 
$ rpm -q vim-enhanced
</pre></li>
</ul>
</div>
</div>
</div>
<div id="outline-container-orgb1fdf68" class="outline-2">
<h2 id="orgb1fdf68">References</h2>
<div class="outline-text-2" id="text-orgb1fdf68">
<ul class="org-ul">
<li><a href="https://harttle.land/2016/08/08/vim-search-in-file.html">在 Vim 中优雅地查找和替换</a></li>
</ul>
</div>
</div>
