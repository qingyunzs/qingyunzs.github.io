
<!doctype html>














<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/assets/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/assets/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/assets/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="C#," />





  <link rel="alternate" href="/atom.xml" title="Rengui's Article" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico?v=5.1.1" />
















<meta name="description" content="C# 开发笔记">
<meta name="keywords" content="C#">
<meta property="og:type" content="article">
<meta property="og:title" content="C# Notes">
<meta property="og:url" content="http://localhost:4000/c%23/2014/05/10/c-notes/">
<meta property="og:site_name" content="Rengui's Article">
<meta property="og:description" content="C# 开发笔记">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="C# Notes">
<meta name="twitter:description" content="C# 开发笔记">


<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://localhost:4000/"/>





  <title>C# Notes | Rengui's Article</title>
  




<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-123739978-1', 'auto');
  ga('send', 'pageview');
</script>













</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Rengui's Article</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Blog, Article</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

<div id="posts" class="posts-expand">
  
  

  

  
  
  

  <article class="post post-type- " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://localhost:4000/c%23/2014/05/10/c-notes/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhao Rengui">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Rengui's Article">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
          
          
            C# Notes
          
        </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-05-10T00:00:00+08:00">
                2014-05-10
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/category/#/C%23" itemprop="url" rel="index">
                    <span itemprop="name">C#</span>
                  </a>
                </span>

                
                
              
            </span>
          

          

          
          

          

          

          
            
                <div class="post-description">
                    C# 开发笔记
                </div>
            
          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
  
  












  <div id="outline-container-org6294bae" class="outline-2">
<h2 id="org6294bae">字符串操作</h2>
<div class="outline-text-2" id="text-org6294bae">
</div>
<div id="outline-container-org164c91d" class="outline-3">
<h3 id="org164c91d">String.Substring()</h3>
<div class="outline-text-3" id="text-org164c91d">
<pre class="example">
//格式
String.Substring(int beginIndex)
String.Substring(int beginIndex,int endIndex)
//示例
string str_new=str.Substring(6,2)：表示从str中截取位置为6的字符开始长度为2的字符串，6表示子字符的起始位置，2表示子字符的字符长度。

</pre>
</div>
</div>
<div id="outline-container-orgd472224" class="outline-3">
<h3 id="orgd472224">其他方法</h3>
<div class="outline-text-3" id="text-orgd472224">
<pre class="example">
//格式
int indexOf(String str) 返回第一次出现的指定子字符串在此字符串中的索引。
int indexOf(String str, int fromIndex) 从指定的索引处开始，返回第一次出现的指定子字符串在此字符串中的索引。
int lastIndexOf(String str) 返回在此字符串中最右边出现的指定子字符串的索引。
int lastIndexOf(String str, int fromIndex) 从指定的索引处开始向后搜索，返回在此字符串中最后一次出现的指定子字符串的索引。 
int length() 返回此字符串的长度。
boolean startsWith(String prefix) 测试此字符串是否以指定的前缀开始。 
boolean startsWith(String prefix, int toffset) 测试此字符串是否以指定前缀开始，该前缀以指定索引开始。
//示例
str.Substring(0,str.LastIndexOf(","));

</pre>
</div>
</div>
<div id="outline-container-org25a1df7" class="outline-3">
<h3 id="org25a1df7">参考资料</h3>
<div class="outline-text-3" id="text-org25a1df7">
<pre class="example">
http://www.blogjava.net/AndyZhang/archive/2012/04/25/376614.html
http://www.cnblogs.com/rocblog/archive/2013/05/07/3064593.html
http://www.cnblogs.com/Deckard/archive/2009/06/03/1495452.html

</pre>
</div>
</div>
</div>
<div id="outline-container-org6c7218a" class="outline-2">
<h2 id="org6c7218a">日期时间处理</h2>
<div class="outline-text-2" id="text-org6c7218a">
</div>
<div id="outline-container-orge8f6d9d" class="outline-3">
<h3 id="orge8f6d9d">C#正则表达式判断输入日期格式是否正确</h3>
<div class="outline-text-3" id="text-orge8f6d9d">
<div class="org-src-container">
<pre class="src src-emacs-lisp">/// &lt;summary&gt;
/// &#26159;&#21542;&#20026;&#26085;&#26399;&#22411;&#23383;&#31526;&#20018;
/// &lt;/summary&gt;
/// &lt;param name=<span style="color: #5c3566;">"StrSource"</span>&gt;&#26085;&#26399;&#23383;&#31526;&#20018;(2008-05-08)&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
public static bool IsDate(string StrSource)
{
     return Regex.IsMatch(StrSource, @<span style="color: #5c3566;">"^((((1[6-9]|[2-9]\d)\d{2})-(0?[13578]|1[02])-(0?[1-9]|[12]\d|3[01]))|(((1[6-9]|[2-9]\d)\d{2})-(0?[13456789]|1[012])-(0?[1-9]|[12]\d|30))|(((1[6-9]|[2-9]\d)\d{2})-0?2-(0?[1-9]|1\d|2[0-9]))|(((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))-0?2-29-))$"</span>)<span style="color: #5f615c; font-style: italic;">;</span>
}
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">/// &lt;summary&gt;
/// &#26159;&#21542;&#20026;&#26102;&#38388;&#22411;&#23383;&#31526;&#20018;
// &lt;/summary&gt;
/// &lt;param name=<span style="color: #5c3566;">"source"</span>&gt;&#26102;&#38388;&#23383;&#31526;&#20018;(15:00:00)&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
public static bool IsTime(string StrSource)
{
     return Regex.IsMatch(StrSource, @<span style="color: #5c3566;">"^((20|21|22|23|[0-1]?\d):[0-5]?\d:[0-5]?\d)$"</span>)<span style="color: #5f615c; font-style: italic;">;</span>
}
</pre>
</div>
<div class="org-src-container">
<pre class="src src-emacs-lisp">/// &lt;summary&gt;
/// &#26159;&#21542;&#20026;&#26085;&#26399;+&#26102;&#38388;&#22411;&#23383;&#31526;&#20018;
/// &lt;/summary&gt;
/// &lt;param name=<span style="color: #5c3566;">"source"</span>&gt;&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
public static bool IsDateTime(string StrSource)
{
    return Regex.IsMatch(StrSource, @<span style="color: #5c3566;">"^(((((1[6-9]|[2-9]\d)\d{2})-(0?[13578]|1[02])-(0?[1-9]|[12]\d|3[01]))|(((1[6-9]|[2-9]\d)\d{2})-(0?[13456789]|1[012])-(0?[1-9]|[12]\d|30))|(((1[6-9]|[2-9]\d)\d{2})-0?2-(0?[1-9]|1\d|2[0-8]))|(((1[6-9]|[2-9]\d)(0[48]|[2468][048]|[13579][26])|((16|[2468][048]|[3579][26])00))-0?2-29-)) (20|21|22|23|[0-1]?\d):[0-5]?\d:[0-5]?\d)$ "</span>)<span style="color: #5f615c; font-style: italic;">;</span>
}
</pre>
</div>
</div>
</div>
<div id="outline-container-org1c3cc38" class="outline-3">
<h3 id="org1c3cc38">C#利用线程、委托，实时显示时间</h3>
<div class="outline-text-3" id="text-org1c3cc38">
<div class="org-src-container">
<pre class="src src-emacs-lisp">#region &#36816;&#34892;&#26102;&#26174;&#31034;&#23454;&#26102;&#26102;&#38388;
new Thread(() =&gt;
{
        while (true)
        {
       try
           {
           labelTime.BeginInvoke(new MethodInvoker(() =&gt; labelTime.Text = DateTime.Now.ToString()))<span style="color: #5f615c; font-style: italic;">;</span>
       }
       catch (Exception)
       {
           }
       Thread.Sleep(1000)<span style="color: #5f615c; font-style: italic;">;</span>
     }
    })
  { IsBackground = true }.Start()<span style="color: #5f615c; font-style: italic;">;</span>
#endregion
</pre>
</div>
</div>
</div>
</div>

<div id="outline-container-org56bef28" class="outline-2">
<h2 id="org56bef28">C#中无法引用自己创建的类库中的类</h2>
<div class="outline-text-2" id="text-org56bef28">
</div>
<div id="outline-container-orgd573f3b" class="outline-3">
<h3 id="orgd573f3b">问题描述</h3>
<div class="outline-text-3" id="text-orgd573f3b">
<pre class="example">
新建一个类，定义了一些方法，在外部引用该类时，不能引用。

</pre>
</div>
</div>
<div id="outline-container-org220768c" class="outline-3">
<h3 id="org220768c">解决办法</h3>
<div class="outline-text-3" id="text-org220768c">
<pre class="example">
1.检查类前面有没有添加加或使用public。
2.类中定义的方法也应该是public类型的
3.改完之后将该类库重新生成一次
4.注意类名不要与系统保留字冲突

</pre>
</div>
</div>
<div id="outline-container-org8d61839" class="outline-3">
<h3 id="org8d61839">参考资料</h3>
<div class="outline-text-3" id="text-org8d61839">
<pre class="example">
https://www.ezloo.com/2008/10/classlibrary_visited.html

</pre>
</div>
</div>
</div>
<div id="outline-container-orgc6bb837" class="outline-2">
<h2 id="orgc6bb837">获取指定范围的n个随机数</h2>
<div class="outline-text-2" id="text-orgc6bb837">
<div class="org-src-container">
<pre class="src src-emacs-lisp">#region &#38543;&#26426;&#25968;&#33719;&#21462;
        /**
         * &#33719;&#21462;&#35268;&#23450;&#33539;&#22260;&#20869;&#30340;n&#20010;&#38543;&#26426;&#25968;
         * 
         * min_value    int    &#38543;&#26426;&#25968;&#19979;&#38480;
         * max_value    int    &#38543;&#26426;&#25968;&#19978;&#38480;
         * number       int    &#38543;&#26426;&#25968;&#37327;
         */
        private string getRandom(int min_value, int max_value, int number)
        {
            Random random = new Random()<span style="color: #5f615c; font-style: italic;">;</span>
            ArrayList arr = new ArrayList()<span style="color: #5f615c; font-style: italic;">;</span>
            int temp = 0<span style="color: #5f615c; font-style: italic;">;</span>
            for (int i = 0<span style="color: #5f615c; font-style: italic;">; </span><span style="color: #5f615c; font-style: italic;">i &lt; number; i++)</span>
            {
                temp = random.Next(min_value, max_value)<span style="color: #5f615c; font-style: italic;">; </span><span style="color: #5f615c; font-style: italic;">//&#38543;&#26426;&#21462;&#25968;</span>
                arr.Add(temp)<span style="color: #5f615c; font-style: italic;">;</span>
            }
            string str = <span style="color: #5c3566;">""</span><span style="color: #5f615c; font-style: italic;">;</span>
            for (int j = 0<span style="color: #5f615c; font-style: italic;">; </span><span style="color: #5f615c; font-style: italic;">j &lt; arr.Count; j++)</span>
            {
                str += arr[j].ToString() + <span style="color: #5c3566;">","</span><span style="color: #5f615c; font-style: italic;">;</span>
                //Console.Write(arr[j].ToString())<span style="color: #5f615c; font-style: italic;">;</span>
            }
            return str.Substring(0, str.LastIndexOf(<span style="color: #5c3566;">","</span>))<span style="color: #5f615c; font-style: italic;">;</span>
        }
#endregion
</pre>
</div>
</div>
</div>
<div id="outline-container-org6c78178" class="outline-2">
<h2 id="org6c78178">DataTable 序列化</h2>
<div class="outline-text-2" id="text-org6c78178">
<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org15447ab">/// &lt;summary&gt;
/// &#24207;&#21015;&#21270;DataTable&#25104;XML
/// &lt;/summary&gt;
/// &lt;param name=<span style="color: #5c3566;">"dt"</span>&gt;&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
private static string SerializeDataTableToXml(DataTable dt)
{
    StringBuilder strBuilder = new StringBuilder()<span style="color: #5f615c; font-style: italic;">;</span>
    XmlWriter writer = XmlWriter.Create(strBuilder)<span style="color: #5f615c; font-style: italic;">;</span>
    XmlSerializer serializer = new XmlSerializer(typeof(DataTable))<span style="color: #5f615c; font-style: italic;">;</span>
    serializer.Serialize(writer, dt)<span style="color: #5f615c; font-style: italic;">;</span>
    writer.Close()<span style="color: #5f615c; font-style: italic;">;</span>
    return strBuilder.ToString()<span style="color: #5f615c; font-style: italic;">;</span>
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orgcc51c7f">/// &lt;summary&gt;
/// &#24207;&#21015;&#21270;XML&#25104;DataTable
/// &lt;/summary&gt;
/// &lt;param name=<span style="color: #5c3566;">"xml"</span>&gt;&lt;/param&gt;
/// &lt;returns&gt;&lt;/returns&gt;
private static DataTable SerializeXmlToDataTable(string xml)
{
    StringReader strReader = new StringReader(xml)<span style="color: #5f615c; font-style: italic;">;</span>
    XmlReader xmlReader = XmlReader.Create(strReader)<span style="color: #5f615c; font-style: italic;">;</span>
    XmlSerializer serializer = new XmlSerializer(typeof(DataTable))<span style="color: #5f615c; font-style: italic;">;</span>
    DataTable dt = serializer.Deserialize(xmlReader) as DataTable<span style="color: #5f615c; font-style: italic;">;</span>
    return dt<span style="color: #5f615c; font-style: italic;">;</span>
}
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org009ffa7">DMWebSvrSoapClient dmwss = new DMWebSvrSoapClient()<span style="color: #5f615c; font-style: italic;">;</span>
DateTime date = DateTime.Now<span style="color: #5f615c; font-style: italic;">;</span>
string dataStr1 = dmwss.GetVehicleInfo_Month(date.ToString(<span style="color: #5c3566;">"yyyy-MM-dd"</span>))<span style="color: #5f615c; font-style: italic;">;</span>

XmlDocument xmldoc = new XmlDocument()<span style="color: #5f615c; font-style: italic;">;</span>
xmldoc.LoadXml(dataStr1)<span style="color: #5f615c; font-style: italic;">;</span>
XmlNodeList xnList = xmldoc.SelectNodes(<span style="color: #5c3566;">"//DocumentElement/list"</span>)<span style="color: #5f615c; font-style: italic;">;</span>
foreach (XmlNode xn in xnList)
{
     ListViewItem item = new ListViewItem(xn[<span style="color: #5c3566;">"time"</span>].InnerText)<span style="color: #5f615c; font-style: italic;">;</span>
     item.SubItems.Add(xn[<span style="color: #5c3566;">"in_vehicle_count"</span>].InnerText)<span style="color: #5f615c; font-style: italic;">;</span>
     item.SubItems.Add(xn[<span style="color: #5c3566;">"out_vehicle_count"</span>].InnerText)<span style="color: #5f615c; font-style: italic;">;</span>
     listView.Items.Add(item)<span style="color: #5f615c; font-style: italic;">;</span>
}
</pre>
</div>
</div>
<div id="outline-container-org2347ba5" class="outline-3">
<h3 id="org2347ba5">参考资料</h3>
<div class="outline-text-3" id="text-org2347ba5">
<pre class="example">
http://stackoverflow.com/questions/6402596/xml-string-to-xml-document
https://zhidao.baidu.com/question/574030822.html
https://msdn.microsoft.com/en-us/library/hcebdtae(v=vs.110).aspx

</pre>
</div>
</div>
</div>


      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            
            <a href="/tag/#/C%23" rel="tag"># C#</a>
          
        </div>
      

      
      
      
      
      

      
      
        <div class="post-nav" id="post-nav-id">
          <div class="post-nav-next post-nav-item">
            
              <a href="/algorithms/2014/05/25/algorithms-family/" rel="next" title="算法之家">
                <i class="fa fa-chevron-left"></i> 算法之家
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/algorithms/2014/03/12/project-euler/" rel="prev" title="Project Euler">
                Project Euler <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      
      

      
    </footer>
  </article>

  <div class="post-spread">
    
  </div>
</div>


          </div>
          


          

        </div>
        
          

  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      
        
        
        







      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/assets/images/avatar.gif"
               alt="Zhao Rengui" />
          <p class="site-author-name" itemprop="name">Zhao Rengui</p>
           
              <p class="site-description motion-element" itemprop="description">Life doesn't just happen to you; you receive everything in your life based on what you've given. 生命中的一切都不是巧合，你得到什么，是源于你付出了什么。</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">46</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/">
                <span class="site-state-item-count">45</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
        
        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              
              
              <span class="links-of-author-item">
                <a href="https://github.com/zhaorengui" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              
              
              <span class="links-of-author-item">
                <a href="https://weibo.com/zhaorengui" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            








            
              <div class="post-toc-content">
    <ol class=nav>
      <li class="nav-item nav-level-2"> <a class="nav-link" href="#org6294bae"> <span class="nav-number">1</span> <span class="nav-text">字符串操作</span> </a> <ol class="nav-child"> <li class="nav-item nav-level-3"> <a class="nav-link" href="#org164c91d"> <span class="nav-number">1.1</span> <span class="nav-text">String.Substring()</span> </a> </li> <li class="nav-item nav-level-3"> <a class="nav-link" href="#orgd472224"> <span class="nav-number">1.2</span> <span class="nav-text">其他方法</span> </a> </li> <li class="nav-item nav-level-3"> <a class="nav-link" href="#org25a1df7"> <span class="nav-number">1.3</span> <span class="nav-text">参考资料</span> </a> </li> </ol> </li> <li class="nav-item nav-level-2"> <a class="nav-link" href="#org6c7218a"> <span class="nav-number">2</span> <span class="nav-text">日期时间处理</span> </a> <ol class="nav-child"> <li class="nav-item nav-level-3"> <a class="nav-link" href="#orge8f6d9d"> <span class="nav-number">2.1</span> <span class="nav-text">C#正则表达式判断输入日期格式是否正确</span> </a> </li> <li class="nav-item nav-level-3"> <a class="nav-link" href="#org1c3cc38"> <span class="nav-number">2.2</span> <span class="nav-text">C#利用线程、委托，实时显示时间</span> </a> </li> </ol> </li> <li class="nav-item nav-level-2"> <a class="nav-link" href="#org56bef28"> <span class="nav-number">3</span> <span class="nav-text">C#中无法引用自己创建的类库中的类</span> </a> <ol class="nav-child"> <li class="nav-item nav-level-3"> <a class="nav-link" href="#orgd573f3b"> <span class="nav-number">3.1</span> <span class="nav-text">问题描述</span> </a> </li> <li class="nav-item nav-level-3"> <a class="nav-link" href="#org220768c"> <span class="nav-number">3.2</span> <span class="nav-text">解决办法</span> </a> </li> <li class="nav-item nav-level-3"> <a class="nav-link" href="#org8d61839"> <span class="nav-number">3.3</span> <span class="nav-text">参考资料</span> </a> </li> </ol> </li> <li class="nav-item nav-level-2"> <a class="nav-link" href="#orgc6bb837"> <span class="nav-number">4</span> <span class="nav-text">获取指定范围的n个随机数</span> </a> </li> <li class="nav-item nav-level-2"> <a class="nav-link" href="#org6c78178"> <span class="nav-number">5</span> <span class="nav-text">DataTable 序列化</span> </a> <ol class="nav-child"> <li class="nav-item nav-level-3"> <a class="nav-link" href="#org2347ba5"> <span class="nav-number">5.1</span> <span class="nav-text">参考资料</span> </a> </li> </ol> </li>
    </ol>
  </div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>

        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhao Rengui</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://jekyllrb.com">Jekyll</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/simpleyyt/jekyll-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>





















  
   
  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/jquery/index.js?v=2.1.3"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  
  
  
  
  <script type="text/javascript" src="/assets/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/assets/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/assets/js/src/motion.js?v=5.1.1"></script>



  
  

  <script type="text/javascript" src="/assets/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/assets/js/src/post-details.js?v=5.1.1"></script>


  


  <script type="text/javascript" src="/assets/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  











  




  

    

  





  


  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  


  

  

  

</body>
</html>

